---
title: Cola de Moderación - Sistema de Revisión Completo
description: Domina la moderación de contenido con sistema de reporte, proceso de apelación, reglas de automoderación, colaboración en equipo y cola de prioridad. Construye herramientas de moderación listas para producción.
---

# Advertencia

:::u-alert
---
title: Los comentarios en el código son solo para fines educativos.
description: En proyectos reales, evita agregar comentarios irrelevantes o redundantes.
color: warning
variant: subtle
icon: i-lucide-triangle-alert
---
:::

La cola de moderación muestra contenido reportado para revisión. Los moderadores pueden aprobar, eliminar o banear usuarios.

---

## Cola de Moderación

```tsx
// src/pages/admin/ModerationQueuePage.tsx

import { useState, useEffect } from 'react'
import { apiClient } from '@/lib/api-client'

interface Report {
  id: string
  type: 'thread' | 'post'
  contentId: string
  contentPreview: string
  reason: string
  reportedBy: string
  reportedAt: string
  status: 'pending' | 'approved' | 'rejected'
}

export function ModerationQueuePage() {
  const [reports, setReports] = useState<Report[]>([])
  const [filter, setFilter] = useState<'all' | 'pending'>('pending')

  useEffect(() => {
    fetchReports()
  }, [])

  const fetchReports = async () => {
    const response = await apiClient.get<Report[]>('/admin/reports')
    setReports(response.data)
  }

  const handleApprove = async (reportId: string) => {
    await apiClient.post(`/admin/reports/${reportId}/approve`)
    setReports(reports.map(r => r.id === reportId ? { ...r, status: 'approved' } : r))
  }

  const handleDelete = async (reportId: string) => {
    await apiClient.post(`/admin/reports/${reportId}/delete`)
    setReports(reports.map(r => r.id === reportId ? { ...r, status: 'rejected' } : r))
  }

  const filteredReports = filter === 'all'
    ? reports
    : reports.filter(r => r.status === 'pending')

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold mb-8">Cola de Moderación</h1>

      <div className="mb-6 flex gap-2">
        <button
          onClick={() => setFilter('all')}
          className={`px-4 py-2 rounded-lg ${
            filter === 'all' ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-300'
          }`}
        >
          Todos ({reports.length})
        </button>
        <button
          onClick={() => setFilter('pending')}
          className={`px-4 py-2 rounded-lg ${
            filter === 'pending' ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-300'
          }`}
        >
          Pendientes ({reports.filter(r => r.status === 'pending').length})
        </button>
      </div>

      <div className="space-y-4">
        {filteredReports.map(report => (
          <div key={report.id} className="p-6 bg-slate-900 rounded-lg border border-slate-800">
            <div className="flex items-start justify-between mb-4">
              <div>
                <span className="px-2 py-1 bg-yellow-600 text-white rounded text-xs">
                  {report.type}
                </span>
                <span className="ml-2 text-sm text-slate-400">
                  Reportado por {report.reportedBy}
                </span>
              </div>
              <span className={`px-2 py-1 rounded text-xs ${
                report.status === 'pending' ? 'bg-yellow-600' :
                report.status === 'approved' ? 'bg-green-600' :
                'bg-red-600'
              } text-white`}>
                {report.status}
              </span>
            </div>

            <p className="text-sm text-slate-300 mb-2"><strong>Razón:</strong> {report.reason}</p>
            <div className="p-4 bg-slate-800 rounded mb-4">
              <p className="text-sm text-slate-400">{report.contentPreview}</p>
            </div>

            {report.status === 'pending' && (
              <div className="flex gap-3">
                <button
                  onClick={() => handleApprove(report.id)}
                  className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                >
                  Aprobar (Mantener Contenido)
                </button>
                <button
                  onClick={() => handleDelete(report.id)}
                  className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                >
                  Eliminar Contenido
                </button>
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  )
}
```

---

## Sistema de Reporte

```tsx
// src/components/moderation/FlagContent.tsx

export function FlagContent({ contentId, contentType }) {
  const [reason, setReason] = useState('')
  const [category, setCategory] = useState('')

  const handleFlag = async () => {
    await apiClient.post('/reports', {
      contentId,
      contentType,
      reason,
      category,
    })
  }

  return (
    <div className="p-4 bg-slate-900 rounded-lg">
      <h3 className="font-bold mb-4">Reportar Contenido</h3>
      
      <select
        value={category}
        onChange={(e) => setCategory(e.target.value)}
        className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg mb-4"
      >
        <option value="">Seleccionar razón...</option>
        <option value="spam">Spam</option>
        <option value="harassment">Acoso</option>
        <option value="hate_speech">Discurso de Odio</option>
        <option value="misinformation">Desinformación</option>
        <option value="other">Otro</option>
      </select>

      <textarea
        value={reason}
        onChange={(e) => setReason(e.target.value)}
        rows={4}
        className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg mb-4"
        placeholder="Proporciona detalles adicionales..."
      />

      <button
        onClick={handleFlag}
        className="w-full px-4 py-2 bg-red-600 text-white rounded-lg"
      >
        Enviar Reporte
      </button>
    </div>
  )
}
```

---

## Proceso de Apelación

```tsx
// src/components/moderation/AppealModal.tsx

export function AppealModal({ report, onClose }) {
  const [appeal, setAppeal] = useState('')

  const handleSubmit = async () => {
    await apiClient.post(`/reports/${report.id}/appeal`, {
      message: appeal,
    })
    onClose()
  }

  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center">
      <div className="bg-slate-900 p-6 rounded-lg max-w-md w-full">
        <h2 className="text-2xl font-bold mb-4">Apelar Decisión</h2>

        <div className="mb-4 p-4 bg-slate-800 rounded-lg">
          <p className="text-sm text-slate-400 mb-2">Decisión Original:</p>
          <p className="text-slate-300">{report.moderatorNote}</p>
        </div>

        <textarea
          value={appeal}
          onChange={(e) => setAppeal(e.target.value)}
          rows={6}
          className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg mb-4"
          placeholder="Explica por qué crees que esta decisión debería ser revertida..."
        />

        <div className="flex gap-2">
          <button
            onClick={handleSubmit}
            className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg"
          >
            Enviar Apelación
          </button>
          <button
            onClick={onClose}
            className="px-4 py-2 bg-slate-700 text-white rounded-lg"
          >
            Cancelar
          </button>
        </div>
      </div>
    </div>
  )
}
```

---

## Reglas de Automoderación

```tsx
// src/utils/auto-moderation.ts

export const AUTO_MOD_RULES = {
  spam: {
    enabled: true,
    actions: ['flag', 'hide'],
    patterns: [
      /buy now/i,
      /click here/i,
      /limited time/i,
    ],
  },
  profanity: {
    enabled: true,
    actions: ['flag', 'warn'],
    words: ['badword1', 'badword2'],
  },
  links: {
    enabled: true,
    maxLinks: 3,
    actions: ['flag'],
  },
}

export function checkAutoModeration(content: string) {
  const violations = []

  // Verificar patrones de spam
  if (AUTO_MOD_RULES.spam.enabled) {
    for (const pattern of AUTO_MOD_RULES.spam.patterns) {
      if (pattern.test(content)) {
        violations.push({
          rule: 'spam',
          severity: 'high',
          actions: AUTO_MOD_RULES.spam.actions,
        })
      }
    }
  }

  // Verificar profanidad
  if (AUTO_MOD_RULES.profanity.enabled) {
    for (const word of AUTO_MOD_RULES.profanity.words) {
      if (content.toLowerCase().includes(word)) {
        violations.push({
          rule: 'profanity',
          severity: 'medium',
          actions: AUTO_MOD_RULES.profanity.actions,
        })
      }
    }
  }

  // Verificar enlaces
  if (AUTO_MOD_RULES.links.enabled) {
    const linkCount = (content.match(/https?:\/\//g) || []).length
    if (linkCount > AUTO_MOD_RULES.links.maxLinks) {
      violations.push({
        rule: 'excessive_links',
        severity: 'medium',
        actions: AUTO_MOD_RULES.links.actions,
      })
    }
  }

  return violations
}
```

---

## Colaboración en Equipo

```tsx
// src/components/moderation/ModerationNotes.tsx

export function ModerationNotes({ reportId }) {
  const [notes, setNotes] = useState([])
  const [newNote, setNewNote] = useState('')

  const addNote = async () => {
    const response = await apiClient.post(`/reports/${reportId}/notes`, {
      content: newNote,
    })
    setNotes([...notes, response.data])
    setNewNote('')
  }

  return (
    <div className="p-4 bg-slate-900 rounded-lg">
      <h3 className="font-bold mb-4">Notas de Moderación</h3>

      <div className="space-y-3 mb-4">
        {notes.map(note => (
          <div key={note.id} className="p-3 bg-slate-800 rounded-lg">
            <div className="flex items-center gap-2 mb-2">
              <span className="font-medium text-sm">{note.moderator.username}</span>
              <span className="text-xs text-slate-500">
                {formatDistanceToNow(new Date(note.createdAt))}
              </span>
            </div>
            <p className="text-sm text-slate-300">{note.content}</p>
          </div>
        ))}
      </div>

      <textarea
        value={newNote}
        onChange={(e) => setNewNote(e.target.value)}
        rows={3}
        className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg mb-2"
        placeholder="Agregar una nota para otros moderadores..."
      />

      <button
        onClick={addNote}
        className="w-full px-4 py-2 bg-blue-600 text-white rounded-lg"
      >
        Agregar Nota
      </button>
    </div>
  )
}
```

---

## Cola de Prioridad

```tsx
// src/utils/priority-queue.ts

export function calculatePriority(report: Report): number {
  let priority = 0

  // Alta prioridad para ciertas categorías
  if (report.category === 'hate_speech') priority += 100
  if (report.category === 'harassment') priority += 80
  if (report.category === 'spam') priority += 20

  // Múltiples reportes aumentan la prioridad
  priority += report.reportCount * 10

  // Reportes recientes tienen mayor prioridad
  const hoursSinceReport = (Date.now() - new Date(report.createdAt).getTime()) / (1000 * 60 * 60)
  if (hoursSinceReport < 1) priority += 50
  else if (hoursSinceReport < 24) priority += 20

  // El historial del usuario afecta la prioridad
  if (report.reportedUser.previousViolations > 0) {
    priority += report.reportedUser.previousViolations * 15
  }

  return priority
}

export function sortByPriority(reports: Report[]): Report[] {
  return reports.sort((a, b) => {
    const priorityA = calculatePriority(a)
    const priorityB = calculatePriority(b)
    return priorityB - priorityA
  })
}
```

---

## Resumen

### Características Clave

1. **Sistema de Reporte**: Reporte de contenido amigable para usuarios
2. **Proceso de Apelación**: Permitir que los usuarios impugnen decisiones
3. **Automoderación**: Detección automática de violaciones
4. **Colaboración en Equipo**: Notas y comunicación
5. **Cola de Prioridad**: Ordenamiento inteligente de reportes

---

## ¡Módulo de Administración Completo!

Has dominado:
- Panel de administración con estadísticas en tiempo real y gráficos
- Gestión de usuarios con operaciones masivas y analíticas
- Cola de moderación con características avanzadas

---

Siguiente: [Temas Avanzados →](/es/react/9.advanced-topics/1.performance)
