---
title: Gestión de Usuarios - Control Administrativo Completo
description: Domina la gestión de usuarios con operaciones masivas, filtros avanzados, analíticas, flujos de baneo/suspensión y cumplimiento GDPR. Construye herramientas de administración listas para producción.
---

# Advertencia

:::u-alert
---
title: Los comentarios en el código son solo para fines educativos.
description: En proyectos reales, evita agregar comentarios irrelevantes o redundantes.
color: warning
variant: subtle
icon: i-lucide-triangle-alert
---
:::

La gestión de usuarios permite a los administradores ver todos los usuarios, cambiar roles, banear usuarios y revisar actividad.

---

## Página de Gestión de Usuarios

```tsx
// src/pages/admin/UserManagementPage.tsx

import { useState, useEffect } from 'react'
import { apiClient } from '@/lib/api-client'

interface User {
  id: string
  username: string
  email: string
  role: 'user' | 'moderator' | 'admin'
  isBanned: boolean
  createdAt: string
  threadCount: number
  postCount: number
}

export function UserManagementPage() {
  const [users, setUsers] = useState<User[]>([])
  const [isLoading, setIsLoading] = useState(true)
  const [searchQuery, setSearchQuery] = useState('')

  useEffect(() => {
    fetchUsers()
  }, [])

  const fetchUsers = async () => {
    try {
      const response = await apiClient.get<User[]>('/admin/users')
      setUsers(response.data)
    } finally {
      setIsLoading(false)
    }
  }

  const handleRoleChange = async (userId: string, newRole: string) => {
    try {
      await apiClient.put(`/admin/users/${userId}/role`, { role: newRole })
      setUsers(users.map(u => u.id === userId ? { ...u, role: newRole } : u))
    } catch (error) {
      // Manejar error
    }
  }

  const handleBan = async (userId: string) => {
    try {
      await apiClient.post(`/admin/users/${userId}/ban`)
      setUsers(users.map(u => u.id === userId ? { ...u, isBanned: true } : u))
    } catch (error) {
      // Manejar error
    }
  }

  const filteredUsers = users.filter(u =>
    u.username.toLowerCase().includes(searchQuery.toLowerCase()) ||
    u.email.toLowerCase().includes(searchQuery.toLowerCase())
  )

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold mb-8">Gestión de Usuarios</h1>

      <input
        type="text"
        value={searchQuery}
        onChange={(e) => setSearchQuery(e.target.value)}
        placeholder="Buscar usuarios..."
        className="w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg mb-6"
      />

      <div className="bg-slate-900 rounded-lg border border-slate-800 overflow-hidden">
        <table className="w-full">
          <thead className="bg-slate-800">
            <tr>
              <th className="px-4 py-3 text-left">Nombre de Usuario</th>
              <th className="px-4 py-3 text-left">Email</th>
              <th className="px-4 py-3 text-left">Rol</th>
              <th className="px-4 py-3 text-left">Actividad</th>
              <th className="px-4 py-3 text-left">Estado</th>
              <th className="px-4 py-3 text-left">Acciones</th>
            </tr>
          </thead>
          <tbody>
            {filteredUsers.map(user => (
              <tr key={user.id} className="border-t border-slate-800">
                <td className="px-4 py-3">{user.username}</td>
                <td className="px-4 py-3">{user.email}</td>
                <td className="px-4 py-3">
                  <select
                    value={user.role}
                    onChange={(e) => handleRoleChange(user.id, e.target.value)}
                    className="px-2 py-1 bg-slate-800 border border-slate-700 rounded"
                  >
                    <option value="user">Usuario</option>
                    <option value="moderator">Moderador</option>
                    <option value="admin">Admin</option>
                  </select>
                </td>
                <td className="px-4 py-3">
                  {user.threadCount} hilos, {user.postCount} posts
                </td>
                <td className="px-4 py-3">
                  {user.isBanned ? (
                    <span className="px-2 py-1 bg-red-600 text-white rounded text-xs">
                      Baneado
                    </span>
                  ) : (
                    <span className="px-2 py-1 bg-green-600 text-white rounded text-xs">
                      Activo
                    </span>
                  )}
                </td>
                <td className="px-4 py-3">
                  {!user.isBanned && (
                    <button
                      onClick={() => handleBan(user.id)}
                      className="px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700"
                    >
                      Banear
                    </button>
                  )}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  )
}
```

---

## Operaciones Masivas

```tsx
// src/components/admin/BulkActions.tsx

export function BulkActions() {
  const [selectedUsers, setSelectedUsers] = useState<string[]>([])
  const [action, setAction] = useState('')

  const handleBulkAction = async () => {
    switch (action) {
      case 'ban':
        await apiClient.post('/admin/users/bulk-ban', { userIds: selectedUsers })
        break
      case 'delete':
        await apiClient.post('/admin/users/bulk-delete', { userIds: selectedUsers })
        break
      case 'export':
        await exportUsers(selectedUsers)
        break
    }
    setSelectedUsers([])
  }

  return (
    <div className="flex items-center gap-4 mb-4">
      <span className="text-sm text-slate-400">
        {selectedUsers.length} seleccionados
      </span>
      
      <select
        value={action}
        onChange={(e) => setAction(e.target.value)}
        className="px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg"
      >
        <option value="">Seleccionar acción...</option>
        <option value="ban">Banear usuarios</option>
        <option value="delete">Eliminar usuarios</option>
        <option value="export">Exportar datos</option>
      </select>
      
      <button
        onClick={handleBulkAction}
        disabled={!action || selectedUsers.length === 0}
        className="px-4 py-2 bg-blue-600 text-white rounded-lg disabled:opacity-50"
      >
        Aplicar
      </button>
    </div>
  )
}
```

---

## Filtros Avanzados

```tsx
// src/components/admin/UserFilters.tsx

export function UserFilters({ onFilterChange }) {
  const [filters, setFilters] = useState({
    role: 'all',
    status: 'all',
    registeredAfter: '',
    minThreads: 0,
  })

  return (
    <div className="grid grid-cols-4 gap-4 mb-6">
      <select
        value={filters.role}
        onChange={(e) => {
          const newFilters = { ...filters, role: e.target.value }
          setFilters(newFilters)
          onFilterChange(newFilters)
        }}
        className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg"
      >
        <option value="all">Todos los Roles</option>
        <option value="user">Usuarios</option>
        <option value="moderator">Moderadores</option>
        <option value="admin">Admins</option>
      </select>

      <select
        value={filters.status}
        onChange={(e) => {
          const newFilters = { ...filters, status: e.target.value }
          setFilters(newFilters)
          onFilterChange(newFilters)
        }}
        className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg"
      >
        <option value="all">Todos los Estados</option>
        <option value="active">Activo</option>
        <option value="banned">Baneado</option>
        <option value="suspended">Suspendido</option>
      </select>

      <input
        type="date"
        value={filters.registeredAfter}
        onChange={(e) => {
          const newFilters = { ...filters, registeredAfter: e.target.value }
          setFilters(newFilters)
          onFilterChange(newFilters)
        }}
        className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg"
        placeholder="Registrado después de..."
      />

      <input
        type="number"
        value={filters.minThreads}
        onChange={(e) => {
          const newFilters = { ...filters, minThreads: parseInt(e.target.value) }
          setFilters(newFilters)
          onFilterChange(newFilters)
        }}
        className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg"
        placeholder="Mínimo de hilos..."
      />
    </div>
  )
}
```

---

## Analíticas de Usuario

```tsx
// src/components/admin/UserAnalytics.tsx

export function UserAnalytics({ userId }: { userId: string }) {
  const [analytics, setAnalytics] = useState(null)

  useEffect(() => {
    fetchAnalytics()
  }, [userId])

  const fetchAnalytics = async () => {
    const response = await apiClient.get(`/admin/users/${userId}/analytics`)
    setAnalytics(response.data)
  }

  if (!analytics) return <div>Cargando...</div>

  return (
    <div className="grid grid-cols-2 gap-4">
      <div className="p-4 bg-slate-900 rounded-lg">
        <h3 className="text-sm font-medium text-slate-400 mb-2">Puntuación de Actividad</h3>
        <p className="text-3xl font-bold">{analytics.activityScore}</p>
        <p className="text-xs text-slate-500 mt-1">
          Basado en posts, hilos e interacción
        </p>
      </div>

      <div className="p-4 bg-slate-900 rounded-lg">
        <h3 className="text-sm font-medium text-slate-400 mb-2">Reputación</h3>
        <p className="text-3xl font-bold">{analytics.reputation}</p>
        <p className="text-xs text-slate-500 mt-1">
          Votos positivos menos votos negativos
        </p>
      </div>

      <div className="p-4 bg-slate-900 rounded-lg">
        <h3 className="text-sm font-medium text-slate-400 mb-2">Reportes Recibidos</h3>
        <p className="text-3xl font-bold text-red-400">{analytics.reportsReceived}</p>
      </div>

      <div className="p-4 bg-slate-900 rounded-lg">
        <h3 className="text-sm font-medium text-slate-400 mb-2">Última Actividad</h3>
        <p className="text-sm">{formatDistanceToNow(new Date(analytics.lastActiveAt))}</p>
      </div>
    </div>
  )
}
```

---

## Flujos de Baneo/Suspensión

```tsx
// src/components/admin/BanUserModal.tsx

export function BanUserModal({ user, onClose, onSuccess }) {
  const [reason, setReason] = useState('')
  const [duration, setDuration] = useState<'permanent' | 'temporary'>('permanent')
  const [days, setDays] = useState(7)

  const handleBan = async () => {
    await apiClient.post(`/admin/users/${user.id}/ban`, {
      reason,
      duration: duration === 'permanent' ? null : days,
    })
    onSuccess()
    onClose()
  }

  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center">
      <div className="bg-slate-900 p-6 rounded-lg max-w-md w-full">
        <h2 className="text-2xl font-bold mb-4">Banear Usuario: {user.username}</h2>

        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium mb-2">Razón</label>
            <textarea
              value={reason}
              onChange={(e) => setReason(e.target.value)}
              rows={4}
              className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg"
              placeholder="Explica por qué este usuario está siendo baneado..."
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Duración</label>
            <select
              value={duration}
              onChange={(e) => setDuration(e.target.value as any)}
              className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg"
            >
              <option value="permanent">Permanente</option>
              <option value="temporary">Temporal</option>
            </select>
          </div>

          {duration === 'temporary' && (
            <div>
              <label className="block text-sm font-medium mb-2">Días</label>
              <input
                type="number"
                value={days}
                onChange={(e) => setDays(parseInt(e.target.value))}
                className="w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg"
              />
            </div>
          )}

          <div className="flex gap-2">
            <button
              onClick={handleBan}
              className="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
            >
              Banear Usuario
            </button>
            <button
              onClick={onClose}
              className="px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600"
            >
              Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}
```

---

## Exportación de Datos GDPR

```tsx
// src/utils/gdpr-export.ts

export async function exportUserData(userId: string) {
  const response = await apiClient.get(`/admin/users/${userId}/export`)
  const data = response.data

  // Crear archivo JSON
  const blob = new Blob([JSON.stringify(data, null, 2)], {
    type: 'application/json',
  })

  // Descargar archivo
  const url = URL.createObjectURL(blob)
  const a = document.createElement('a')
  a.href = url
  a.download = `user-${userId}-data.json`
  a.click()
  URL.revokeObjectURL(url)
}

// La exportación incluye:
// - Perfil de usuario
// - Todos los hilos creados
// - Todos los posts creados
// - Todos los comentarios
// - Historial de actividad
// - Configuraciones
```

---

## Resumen

### Características Clave

1. **Operaciones Masivas**: Banear, eliminar, exportar múltiples usuarios
2. **Filtros Avanzados**: Rol, estado, fecha, actividad
3. **Analíticas de Usuario**: Puntuación de actividad, reputación, reportes
4. **Banear/Suspender**: Temporal o permanente con razones
5. **Cumplimiento GDPR**: Funcionalidad de exportación de datos

---

Siguiente: [Cola de Moderación →](/es/react/8.admin-module/3.moderation-queue)
